<!-- Quiz - CSS -->

<style>
  .tsw-quiz {
    --tsw-font-display: "TeleNeo Web", var(--phx--text-family-brand), -apple-system, BlinkMacSystemFont, "Segoe UI",
      Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    --tsw-font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif,
      "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

    --tsw-font-size: 16px;
    --color-brand-primary-400: #e20074;
    --color-brand-primary-600: #770141;
    --color-brand-grayscale-400: #ccc;
    --color-brand-grayscale-500: #8c8c8c;
    --color-brand-grayscale-600: #6a6a6a;
    --color-brand-grayscale-700: #414141;
    --color-brand-grayscale-900: #1c1c1c;
    --color-brand-grayscale-white: #fff;

    --color-overlay: rgba(0, 0, 0, 0.4);
    --color-input-shadow: 0px 0px 5px 0px rgba(226, 0, 116, 0.5);

    font-family: var(--tsw-font-main);

    --quiz-text-color: var(--color-brand-grayscale-600);
    --quiz-highlight-color: var(--color-brand-primary-400);
    --quiz-background-color: var(--color-brand-grayscale-white);

    color: var(--quiz-text-color);
    background-color: var(--quiz-background-color);
  }

  /* .tsw-quiz.dark-theme {
  --quiz-text-color: var(--color-brand-grayscale-white);
  --quiz-background-color: var(--color-brand-grayscale-900);
} */

  /* Reset */

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: "Arial", sans-serif;
    overflow-x: hidden;
    margin: 0;
  }

  ul {
    list-style-type: none;
  }

  /* Quiz styles */

  .tsw-quiz {
    display: flex;
    justify-content: space-between;
    max-width: 1200px;
    padding: 24px;
    margin: 0 auto;
  }
  @media (min-width: 768px) {
    .tsw-quiz {
      padding: 40px;
    }
  }

  .tsw-quiz h2 {
    color: var(--quiz-highlight-color);
    margin-bottom: 20px;
    line-height: 30px;
  }
  .tsw-quiz h3 {
    color: var(--color-brand-grayscale-900);
    margin-bottom: 20px;
    line-height: 30px;
  }
  .tsw-quiz p {
    line-height: 22px;
  }

  /* Quiz checklist styles */

  .tsw-quiz-checklist {
    display: none;
  }
  @media (min-width: 768px) {
    .tsw-quiz-checklist {
      display: flex;
      flex-direction: column;
      gap: 24px;
      flex: 0 0 260px;
      border-right: 1px solid var(--color-brand-grayscale-400);
    }
  }

  .tsw-quiz-checklist li {
    display: flex;
    align-items: center;
    gap: 7px;
    cursor: pointer;
  }
  .tsw-quiz-checklist li.active {
    color: var(--quiz-highlight-color);
  }
  .tsw-quiz-checklist li svg {
    width: 24px;
    height: 24px;
  }
  .tsw-quiz-checklist .tsw-radio-checked {
    display: none;
  }
  .tsw-quiz-checklist li.active .tsw-radio-checked {
    display: block;
  }
  .tsw-quiz-checklist li.active .tsw-radio-unchecked {
    display: none;
  }

  /* Quiz main div styles */

  .tsw-quiz-main {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  @media (min-width: 768px) {
    .tsw-quiz-main {
      padding: 0 0 0 40px;
    }
  }

  /* Quiz panel styles */

  .tsw-quiz-panels {
    min-height: 350px;
  }

  .tsw-quiz-panel {
    display: none;
    flex-direction: column;
    gap: 40px;
  }
  .tsw-quiz-panel.active {
    display: flex;
  }

  .tsw-quiz-panel-result {
    display: none;
  }
  .tsw-quiz-panel-result.active {
    display: block;
  }

  /* Quiz choice button styles */

  .tsw-quiz-choice-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  .tsw-quiz-choice-buttons label {
    padding: 10px 15px;
    border: 1px solid var(--color-brand-grayscale-900);
    border-radius: 50px;
    height: fit-content;
    line-height: normal;
    cursor: pointer;
    align-self: flex-start; /* This prevents the labels from spanning the full width of the parent */
  }
  .tsw-quiz-choice-buttons input {
    opacity: 0;
    position: absolute;
    width: 0;
    height: 0;
  }
  .tsw-quiz-choice-buttons input:checked + label {
    color: var(--color-brand-grayscale-white);
    background-color: var(--color-brand-grayscale-900);
    border: 1px solid var(--color-brand-grayscale-900);
  }
  .tsw-quiz-choice-buttons input:checked + label::before {
    content: "\2713"; /* Unicode checkmark symbol */
    padding-right: 10px;
  }

  /* Quiz stepper button styles */

  .tsw-quiz-stepper-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 50px;
  }

  .tsw-quiz-stepper-buttons button {
    cursor: pointer;
    padding: 10px 15px;
    font-size: 16px;
    font-weight: 600;
    border: 0;
    border-radius: 5px;
    color: var(--color-brand-grayscale-white);
    background-color: var(--color-brand-primary-400);
    /* box-shadow: 2px 2px 7px rgba(0, 0, 0, 0.5); */
  }
  .tsw-quiz-stepper-buttons button:disabled {
    visibility: hidden;
  }

  /* .tsw-quiz-stepper-buttons button:only-child {
  margin-left: auto;
} */

  /* Quiz svg icon styles */

  .tsw-quiz-svg-icons {
    display: none;
  }
  #tsw-radio-checked-svg {
    fill: var(--quiz-highlight-color);
  }
  #tsw-radio-unchecked-svg {
    fill: var(--quiz-text-color);
  }
</style>

<!-- Quiz - HTML -->

<div class="tsw-quiz">
  <ul class="tsw-quiz-checklist">
    <li>
      <svg class="tsw-radio-checked"><use xlink:href="#tsw-radio-checked-svg" /></svg>
      <svg class="tsw-radio-unchecked"><use xlink:href="#tsw-radio-unchecked-svg" /></svg>
      <span>Getting Started</span>
    </li>
    <li>
      <svg class="tsw-radio-checked"><use xlink:href="#tsw-radio-checked-svg" /></svg>
      <svg class="tsw-radio-unchecked"><use xlink:href="#tsw-radio-unchecked-svg" /></svg>
      <span>Phone Plan</span>
    </li>
    <li>
      <svg class="tsw-radio-checked"><use xlink:href="#tsw-radio-checked-svg" /></svg>
      <svg class="tsw-radio-unchecked"><use xlink:href="#tsw-radio-unchecked-svg" /></svg>
      <span>Line Selection</span>
    </li>
    <li>
      <svg class="tsw-radio-checked"><use xlink:href="#tsw-radio-checked-svg" /></svg>
      <svg class="tsw-radio-unchecked"><use xlink:href="#tsw-radio-unchecked-svg" /></svg>
      <span>Device Compatibility</span>
    </li>
    <li>
      <svg class="tsw-radio-checked"><use xlink:href="#tsw-radio-checked-svg" /></svg>
      <svg class="tsw-radio-unchecked"><use xlink:href="#tsw-radio-unchecked-svg" /></svg>
      <span>Transfer your number</span>
    </li>
    <li>
      <svg class="tsw-radio-checked"><use xlink:href="#tsw-radio-checked-svg" /></svg>
      <svg class="tsw-radio-unchecked"><use xlink:href="#tsw-radio-unchecked-svg" /></svg>
      <span>Review / Switch</span>
    </li>
  </ul>

  <div class="tsw-quiz-main">
    <div class="tsw-quiz-panels">
      <div class="tsw-quiz-panel tsw-quiz-panel--1">
        <div class="tsw-quiz-panel-header">
          <h2>Thinking about switching to T&#8209;Mobile?</h2>
          <p>Answer a few quick questions and we'll help guide you through the process.</p>
        </div>
      </div>
      <div class="tsw-quiz-panel tsw-quiz-panel--2">
        <div class="tsw-quiz-panel-header">
          <h2>Do you know what T&#8209;Mobile phone plan you want?</h2>
          <p>
            Knowing what you want is the first step to switching with confidence. From individual lines to family plans
            packed with value, T&#8209;Mobile makes it easy to find the plan that fits your needs and your budget.
          </p>
        </div>
        <div class="tsw-quiz-choice-buttons">
          <input type="radio" id="tsw-knows-plan--no" name="tsw-knows-plan" value="no" data-target="result-no" />
          <label for="tsw-knows-plan--no">No, I don't know</label>
          <input type="radio" id="tsw-knows-plan--yes" name="tsw-knows-plan" value="yes" data-target="result-yes" />
          <label for="tsw-knows-plan--yes">Yes, I already know my plan</label>
        </div>
        <div class="tsw-quiz-panel-result" id="result-no">
          <h3>That's okay, we'll help you find the perfect plan.</h3>
        </div>
        <div class="tsw-quiz-panel-result" id="result-yes"><h3>Excellent!</h3></div>
      </div>

      <div class="tsw-quiz-panel tsw-quiz-panel--3">
        <div class="tsw-quiz-panel-header">
          <h2>How many lines are you bringing?</h2>
          <p>
            Sed tincidunt nibh posuere fringilla phasellus in elementum. Sodales cursus penatibus cursus amet quisque
            odio ornare. Ullamcorper et enim nullam a est in. Enim diam id egestas aliquet pretium habitasse. Felis
            felis.
          </p>
        </div>
        <div class="tsw-quiz-choice-buttons">
          <input type="radio" id="tsw-lines--1" name="tsw-line-count" value="1" />
          <label for="tsw-lines--1">1</label>
          <input type="radio" id="tsw-lines--2" name="tsw-line-count" value="2" />
          <label for="tsw-lines--2">2</label>
          <input type="radio" id="tsw-lines--3" name="tsw-line-count" value="3" />
          <label for="tsw-lines--3">3</label>
          <input type="radio" id="tsw-lines--4" name="tsw-line-count" value="4" />
          <label for="tsw-lines--4">4</label>
          <input type="radio" id="tsw-lines--5plus" name="tsw-line-count" value="5+" />
          <label for="tsw-lines--5plus">5+</label>
        </div>
      </div>

      <div class="tsw-quiz-panel tsw-quiz-panel--4">
        <div class="tsw-quiz-panel-header">
          <h2>Do you need to buy a new device or are you bringing your own?</h2>
        </div>
        <div class="tsw-quiz-choice-buttons">
          <input type="radio" id="tsw-device--1" name="tsw-device" value="buy" />
          <label for="tsw-device--1">I need to buy a new device</label>
          <input type="radio" id="tsw-device--2" name="tsw-device" value="own" />
          <label for="tsw-device--2">I'm bringing in my own device</label>
          <input type="radio" id="tsw-device--3" name="tsw-device" value="trade" />
          <label for="tsw-device--3">I'd like to trade in my current device</label>
        </div>
      </div>

      <div class="tsw-quiz-panel tsw-quiz-panel--5">
        <div class="tsw-quiz-panel-header">
          <h2>Is your device unlocked?</h2>
        </div>
        <div class="tsw-quiz-choice-buttons">
          <input type="radio" id="tsw-unlocked--1" name="tsw-unlocked" value="no" />
          <label for="tsw-unlocked--1">No</label>
          <input type="radio" id="tsw-unlocked--2" name="tsw-unlocked" value="yes" />
          <label for="tsw-unlocked--2">Yes</label>
          <input type="radio" id="tsw-unlocked--3" name="tsw-unlocked" value="not sure" />
          <label for="tsw-unlocked--3">I'm not sure</label>
        </div>
      </div>

      <div class="tsw-quiz-panel tsw-quiz-panel--6">
        <h2>Panel 6</h2>
      </div>
    </div>

    <div class="tsw-quiz-stepper-buttons">
      <button type="button" class="tsw-quiz-button-back">&lt; Back</button>
      <button type="button" class="tsw-quiz-button-next">Next &gt;</button>
    </div>
  </div>
</div>

<div class="tsw-quiz-svg-icons">
  <svg
    id="tsw-radio-checked-svg"
    xmlns="http://www.w3.org/2000/svg"
    height="24px"
    viewBox="0 -960 960 960"
    width="24px"
    fill="#e3e3e3"
  >
    <path
      d="M480-280q83 0 141.5-58.5T680-480q0-83-58.5-141.5T480-680q-83 0-141.5 58.5T280-480q0 83 58.5 141.5T480-280Zm0 200q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Z"
    />
  </svg>
  <svg
    id="tsw-radio-unchecked-svg"
    xmlns="http://www.w3.org/2000/svg"
    height="24px"
    viewBox="0 -960 960 960"
    width="24px"
    fill="#e3e3e3"
  >
    <path
      d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Z"
    />
  </svg>
</div>

<!-- Quiz - JavaScript -->

<script>
  const quizWrapper = document.querySelector("#tsw-quiz").querySelector("xpr-npi-content").shadowRoot;

  const listItems = quizWrapper.querySelectorAll(".tsw-quiz-checklist li");
  const panels = quizWrapper.querySelectorAll(".tsw-quiz-panel");
  const backButton = quizWrapper.querySelector(".tsw-quiz-button-back");
  const nextButton = quizWrapper.querySelector(".tsw-quiz-button-next");
  const panel2buttons = quizWrapper.querySelectorAll('.tsw-quiz-panel--2 input[type="radio"]');
  const panel2results = quizWrapper.querySelectorAll(".tsw-quiz-panel--2 .tsw-quiz-panel-result");
  const panel3buttons = quizWrapper.querySelectorAll('.tsw-quiz-panel--3 input[type="radio"]');
  const panel3results = quizWrapper.querySelectorAll(".tsw-quiz-panel--3 .tsw-quiz-panel-result");
  const panel4buttons = quizWrapper.querySelectorAll('.tsw-quiz-panel--4 input[type="radio"]');
  const panel4results = quizWrapper.querySelectorAll(".tsw-quiz-panel--4 .tsw-quiz-panel-result");
  const panel5buttons = quizWrapper.querySelectorAll('.tsw-quiz-panel--5 input[type="radio"]');
  const panel5results = quizWrapper.querySelectorAll(".tsw-quiz-panel--5 .tsw-quiz-panel-result");

  // User state object
  let quizState = {
    currentListItem: 0,
    knowsPlan: null,
    lineCount: 0,
    device: null,
    unlocked: null,
  };

  const updateCurrentListItem = (index) => {
    // Remove 'active' from all list items and panels
    listItems.forEach((item) => {
      item.classList.remove("active");
    });
    panels.forEach((panel) => {
      panel.classList.remove("active");
    });

    // Add 'active' to new list item and panel
    listItems[index].classList.add("active");
    panels[index].classList.add("active");

    // Update quizState.currentListItem
    quizState.currentListItem = index;

    // Update local storage
    localStorage.setItem("tsw-quiz", JSON.stringify(quizState));
  };

  const updateStepperButtons = () => {
    backButton.disabled = quizState.currentListItem <= 0;
    nextButton.disabled = quizState.currentListItem >= listItems.length - 1;
  };

  // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
  // List and button event handlers
  // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

  listItems.forEach((item, index) => {
    item.addEventListener("click", () => {
      updateCurrentListItem(index);
      updateStepperButtons();
    });
  });

  // Stepper buttons

  backButton.addEventListener("click", () => {
    updateCurrentListItem(quizState.currentListItem - 1);
    updateStepperButtons();
  });

  nextButton.addEventListener("click", () => {
    updateCurrentListItem(quizState.currentListItem + 1);
    updateStepperButtons();
  });

  // Panel choice buttons and results

  const choiceButtonMaps = [
    { buttons: panel2buttons, results: panel2results, stateKey: "knowsPlan" },
    { buttons: panel3buttons, results: panel3results, stateKey: "lineCount" },
    { buttons: panel4buttons, results: panel4results, stateKey: "device" },
    { buttons: panel5buttons, results: panel5results, stateKey: "unlocked" },
  ];

  choiceButtonMaps.forEach(({ buttons, results, stateKey }) => {
    buttons.forEach((button) => {
      button.addEventListener("change", function () {
        quizState[stateKey] = this.value;
        localStorage.setItem("tsw-quiz", JSON.stringify(quizState));

        results.forEach((result) => {
          result.classList.remove("active");
        });

        const targetId = this.getAttribute("data-target");
        if (targetId) {
          const targetPanel = quizWrapper.getElementById(targetId);
          if (targetPanel) {
            targetPanel.classList.add("active");
          }
        }
      });
    });
  });

  // =-=-=-=
  // On load
  // =-=-=-=

  const initChoiceButtons = (state) => {
    // Set initial value of all choice buttons based on local storage or default
    const buttonMaps = [
      { buttons: panel2buttons, value: state.knowsPlan },
      { buttons: panel3buttons, value: state.lineCount },
      { buttons: panel4buttons, value: state.device },
      { buttons: panel5buttons, value: state.unlocked },
    ];

    buttonMaps.forEach((map) => {
      map.buttons.forEach((button) => {
        if (button.value === map.value) {
          button.checked = true;
        }
      });
    });
  };

  const init = () => {
    const localStorageData = JSON.parse(localStorage.getItem("tsw-quiz"));
    if (localStorageData) quizState = localStorageData;

    updateCurrentListItem(quizState.currentListItem);
    initChoiceButtons(quizState);
    updateStepperButtons();
  };

  init();
</script>
